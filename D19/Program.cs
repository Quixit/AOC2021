// See https://aka.ms/new-console-template for more information

using D19;

var input = new Location[][] {
new Location [] {
new Location(-731,-763,-425   ),
new Location(832,-512,-437    ),
new Location(571,657,-514     ),
new Location(594,551,-569     ),
new Location(-604,638,718     ),
new Location(-536,524,776     ),
new Location(629,721,-564     ),
new Location(-623,-444,440    ),
new Location(-708,-610,437    ),
new Location(550,-524,759     ),
new Location(355,515,510      ),
new Location(-683,877,-615    ),
new Location(763,-622,-365    ),
new Location(-833,-795,-362   ),
new Location(-663,840,-668    ),
new Location(-676,876,-848    ),
new Location(7,-92,-35        ),
new Location(560,-560,695     ),
new Location(-559,539,599     ),
new Location(528,-504,779     ),
new Location(-709,-874,-390   ),
new Location(457,445,563      ),
new Location(841,-410,-363    ),
new Location(-742,-511,374    ),
new Location(422,463,367      ),
},
new Location [] {
new Location(598,477,221      ),
new Location(687,-702,-850    ),
new Location(-586,-650,-945   ),
new Location(-588,-636,-820   ),
new Location(-676,-819,603    ),
new Location(431,-621,738     ),
new Location(-790,449,456     ),
new Location(339,566,-635     ),
new Location(386,708,-671     ),
new Location(466,672,-647     ),
new Location(245,-629,714     ),
new Location(-674,520,398     ),
new Location(-20,-191,-108    ),
new Location(624,398,329      ),
new Location(-712,486,-889    ),
new Location(-851,477,396     ),
new Location(-791,580,-833    ),
new Location(627,330,296      ),
new Location(623,-679,-824    ),
new Location(-859,-833,629    ),
new Location(697,-847,-874    ),
new Location(-463,-586,-905   ),
new Location(-607,554,-853    ),
new Location(-789,-836,551    ),
new Location(-168,-4,-10      ),
new Location(413,-642,724     ),
},
new Location [] {
new Location(676,816,-834     ),
new Location(614,746,-853     ),
new Location(-592,-743,-408   ),
new Location(-72,47,-39       ),
new Location(-744,-404,762    ),
new Location(444,-703,786     ),
new Location(753,-784,-474    ),
new Location(-534,-783,-416   ),
new Location(735,717,-765     ),
new Location(568,482,582      ),
new Location(-343,434,-675    ),
new Location(-488,758,370     ),
new Location(545,517,368      ),
new Location(-489,888,446     ),
new Location(-642,-821,-498   ),
new Location(-351,372,-463    ),
new Location(384,-705,874     ),
new Location(-827,-527,719    ),
new Location(624,-720,837     ),
new Location(88,-28,74        ),
new Location(503,604,524      ),
new Location(-640,-593,761    ),
new Location(-419,427,-552    ),
new Location(690,-818,-490    ),
new Location(-353,831,437     ),
new Location(650,-734,-583    ),
},
new Location[] {
new Location(-561,681,-898    ),
new Location(-696,-781,-955   ),
new Location(674,322,-753     ),
new Location(-631,640,-859    ),
new Location(421,399,364      ),
new Location(-559,-639,519    ),
new Location(451,-574,320     ),
new Location(-599,-747,467    ),
new Location(-813,515,442     ),
new Location(809,328,-802     ),
new Location(478,-579,460     ),
new Location(-710,-656,-826   ),
new Location(455,-597,-612    ),
new Location(-600,-812,-818   ),
new Location(555,-700,367     ),
new Location(593,379,413      ),
new Location(382,-629,-639    ),
new Location(810,259,-767     ),
new Location(-46,21,-86       ),
new Location(-662,548,550     ),
new Location(-618,-569,546    ),
new Location(-710,453,457     ),
new Location(-805,672,-885    ),
new Location(479,482,472      ),
new Location(444,-658,-572    ),
new Location(75,-100,-5       ),
},
new Location[] {
new Location(-720,-688,-429   ),
new Location(75,21,146        ),
new Location(-524,-443,905    ),
new Location(-455,739,547     ),
new Location(28,-141,13       ),
new Location(-697,-360,919    ),
new Location(826,-631,876     ),
new Location(-556,623,540     ),
new Location(710,450,-593     ),
new Location(-545,-345,887    ),
new Location(697,394,-509     ),
new Location(767,-745,773     ),
new Location(875,-803,856     ),
new Location(614,-573,-535    ),
new Location(542,624,862      ),
new Location(-794,439,-772    ),
new Location(561,-428,-543    ),
new Location(-746,370,-754    ),
new Location(-683,-626,-394   ),
new Location(469,634,823      ),
new Location(-628,431,-669    ),
new Location(-754,-741,-370   ),
new Location(741,613,-533     ),
new Location(489,522,847      ),
new Location(-374,623,575     ),
new Location(664,-373,-571    ),
},
new Location[] {
new Location(699,-825,730     ),
new Location(537,-594,-346    ),
new Location(346,566,583      ),
new Location(-631,-481,703    ),
new Location(-787,-523,790    ),
new Location(859,752,-606     ),
new Location(585,-767,662     ),
new Location(424,-689,-351    ),
new Location(-648,384,-472    ),
new Location(684,-648,707     ),
new Location(-709,511,419     ),
new Location(-683,421,-534    ),
new Location(-38,84,173       ),
new Location(-707,350,-419    ),
new Location(-342,-793,-586   ),
new Location(765,684,-628     ),
new Location(-573,-546,825    ),
new Location(493,-563,-373    ),
new Location(-785,510,549     ),
new Location(701,831,-589     ),
new Location(-718,375,476     ),
new Location(-335,-697,-642   ),
new Location(383,619,603      ),
new Location(-293,-795,-521   ),
new Location(347,799,590      ),
new Location(117,6,18         ),
},
new Location[] {
new Location(-716,-702,538    ),
new Location(795,547,748      ),
new Location(-711,527,-540    ),
new Location(601,413,-940     ),
new Location(-863,-529,-512   ),
new Location(388,-501,-871    ),
new Location(-723,-534,-539   ),
new Location(787,759,810      ),
new Location(-637,-524,557    ),
new Location(719,670,755      ),
new Location(300,-440,423     ),
new Location(580,395,-842     ),
new Location(-816,-655,-616   ),
new Location(345,-571,505     ),
new Location(554,-554,-934    ),
new Location(-633,593,601     ),
new Location(-741,560,752     ),
new Location(547,-535,-827    ),
new Location(753,381,-925     ),
new Location(359,-597,479     ),
new Location(-819,444,-482    ),
new Location(10,13,-72        ),
new Location(-664,-594,498    ),
new Location(-770,424,-654    ),
new Location(-726,498,649     ),
},
new Location[] {
new Location(-582,-761,459    ),
new Location(-453,-839,-862   ),
new Location(804,-878,437     ),
new Location(-612,749,581     ),
new Location(436,398,564      ),
new Location(-487,-795,-703   ),
new Location(807,842,-463     ),
new Location(750,-880,275     ),
new Location(-549,511,-891    ),
new Location(718,787,-531     ),
new Location(145,-81,-100     ),
new Location(-503,-738,369    ),
new Location(-600,814,464     ),
new Location(429,-893,-497    ),
new Location(-599,645,571     ),
new Location(-540,-758,410    ),
new Location(718,-866,393     ),
new Location(461,-908,-649    ),
new Location(-523,537,-905    ),
new Location(595,780,-455     ),
new Location(-506,-902,-696   ),
new Location(417,468,502      ),
new Location(505,497,623      ),
new Location(12,47,-20        ),
new Location(-392,455,-950    ),
new Location(443,-810,-670    ),
},
new Location[] {
new Location(53,162,-22       ),
new Location(967,695,948      ),
new Location(770,-615,-548    ),
new Location(-670,-668,425    ),
new Location(968,599,931      ),
new Location(956,564,873      ),
new Location(-402,599,-642    ),
new Location(-440,-235,-401   ),
new Location(840,-611,-438    ),
new Location(684,602,-426     ),
new Location(609,-449,832     ),
new Location(691,788,-464     ),
new Location(-498,984,913     ),
new Location(895,-586,-503    ),
new Location(-501,913,878     ),
new Location(167,129,170      ),
new Location(695,623,-587     ),
new Location(493,-550,825     ),
new Location(-523,556,-616    ),
new Location(-368,-412,-433   ),
new Location(-478,-443,-393   ),
new Location(-7,18,134        ),
new Location(-390,903,852     ),
new Location(-353,475,-643    ),
new Location(609,-631,797     ),
new Location(-691,-717,496    ),
new Location(-674,-800,467    ),
},
new Location[] {
new Location(523,-356,773     ),
new Location(-764,463,-560    ),
new Location(-425,-730,874    ),
new Location(668,-366,749     ),
new Location(728,-640,-825    ),
new Location(67,173,60        ),
new Location(903,419,-683     ),
new Location(-787,551,-542    ),
new Location(-403,-811,707    ),
new Location(889,413,-586     ),
new Location(749,-622,-839    ),
new Location(-763,407,-508    ),
new Location(741,-808,-815    ),
new Location(-699,745,628     ),
new Location(-523,-387,-566   ),
new Location(-489,-747,745    ),
new Location(-606,801,513     ),
new Location(-724,-387,-543   ),
new Location(-647,-369,-544   ),
new Location(-682,846,572     ),
new Location(658,516,448      ),
new Location(518,532,446      ),
new Location(460,523,469      ),
new Location(94,-8,-68        ),
new Location(885,388,-755     ),
new Location(691,-430,723     ),
},
new Location[] {
new Location(632,619,803      ),
new Location(-337,-640,-546   ),
new Location(746,-937,-943    ),
new Location(-81,54,-168      ),
new Location(821,-857,548     ),
new Location(706,756,751      ),
new Location(683,-855,672     ),
new Location(-733,363,-817    ),
new Location(-615,381,-906    ),
new Location(-584,435,-808    ),
new Location(-329,-782,-669   ),
new Location(586,461,-730     ),
new Location(659,730,711      ),
new Location(-493,496,495     ),
new Location(766,-822,-830    ),
new Location(-338,-687,-635   ),
new Location(-589,-913,412    ),
new Location(721,-864,422     ),
new Location(-601,-806,278    ),
new Location(397,451,-676     ),
new Location(-10,-104,0       ),
new Location(-604,404,408     ),
new Location(487,463,-794     ),
new Location(775,-762,-933    ),
new Location(-602,583,413     ),
new Location(-461,-925,315    ),
},
new Location[] {
new Location(-746,899,-576    ),
new Location(407,869,433      ),
new Location(-547,-309,328    ),
new Location(-416,-384,339    ),
new Location(-316,-483,-310   ),
new Location(399,485,-678     ),
new Location(698,-432,802     ),
new Location(-46,-77,89       ),
new Location(-648,857,-455    ),
new Location(-726,877,401     ),
new Location(-478,-429,-312   ),
new Location(-744,850,-511    ),
new Location(608,-772,-282    ),
new Location(433,544,-625     ),
new Location(629,-790,-380    ),
new Location(-729,896,666     ),
new Location(525,784,494      ),
new Location(-451,-326,327    ),
new Location(46,69,-60        ),
new Location(359,887,502      ),
new Location(470,509,-563     ),
new Location(-434,-515,-324   ),
new Location(456,-804,-297    ),
new Location(-788,819,534     ),
new Location(779,-460,686     ),
new Location(597,-425,686     ),
},
new Location[] {
new Location(363,-267,559     ),
new Location(256,-401,547     ),
new Location(-772,-682,-877   ),
new Location(314,-661,-725    ),
new Location(19,64,-38        ),
new Location(-676,-711,473    ),
new Location(-685,590,-796    ),
new Location(-833,-770,417    ),
new Location(-719,-516,-940   ),
new Location(529,557,295      ),
new Location(387,680,287      ),
new Location(-625,644,776     ),
new Location(244,-304,419     ),
new Location(347,841,-808     ),
new Location(407,944,-817     ),
new Location(-702,-725,499    ),
new Location(-173,172,-77     ),
new Location(-738,-523,-833   ),
new Location(-613,761,711     ),
new Location(-722,549,-776    ),
new Location(232,954,-788     ),
new Location(-643,639,-799    ),
new Location(312,-537,-863    ),
new Location(305,-411,-763    ),
new Location(482,646,296      ),
new Location(-626,751,607     ),
},
new Location[] {
new Location(292,-495,571     ),
new Location(651,919,779      ),
new Location(-175,-32,46      ),
new Location(-939,696,356     ),
new Location(-690,411,-464    ),
new Location(-384,-810,562    ),
new Location(-785,-685,-485   ),
new Location(-795,451,-566    ),
new Location(773,-408,-583    ),
new Location(-906,399,-435    ),
new Location(781,-531,-441    ),
new Location(-455,-767,470    ),
new Location(772,-497,-536    ),
new Location(357,-612,559     ),
new Location(-950,531,445     ),
new Location(-455,-745,448    ),
new Location(595,860,622      ),
new Location(649,453,-298     ),
new Location(-917,726,512     ),
new Location(-20,152,68       ),
new Location(-778,-675,-648   ),
new Location(-763,-609,-482   ),
new Location(509,416,-417     ),
new Location(569,874,648      ),
new Location(461,-602,572     ),
new Location(521,550,-310     ),
},
new Location[] {
new Location(-322,-641,670    ),
new Location(-349,354,-648    ),
new Location(-625,714,619     ),
new Location(812,-715,-617    ),
new Location(-491,-748,669    ),
new Location(821,527,-792     ),
new Location(909,550,885      ),
new Location(-599,728,593     ),
new Location(-294,286,-737    ),
new Location(87,-111,72       ),
new Location(354,-956,679     ),
new Location(-668,-679,-347   ),
new Location(425,-891,793     ),
new Location(862,-818,-726    ),
new Location(-387,-758,682    ),
new Location(887,580,729      ),
new Location(425,-913,771     ),
new Location(-639,-800,-435   ),
new Location(-356,278,-525    ),
new Location(-46,-32,-48      ),
new Location(899,577,-702     ),
new Location(896,-755,-710    ),
new Location(920,385,796      ),
new Location(861,469,-784     ),
new Location(-738,-741,-366   ),
new Location(-681,773,462     ),
},
new Location[] {
new Location(-863,636,832     ),
new Location(887,603,374      ),
new Location(-66,-152,-18     ),
new Location(-406,-515,-665   ),
new Location(-501,-905,785    ),
new Location(542,-591,-441    ),
new Location(790,520,-691     ),
new Location(562,-667,653     ),
new Location(888,610,607      ),
new Location(-680,319,-645    ),
new Location(-611,-836,857    ),
new Location(813,415,-771     ),
new Location(732,-702,658     ),
new Location(668,-644,708     ),
new Location(-784,760,860     ),
new Location(-380,-439,-590   ),
new Location(66,2,27          ),
new Location(-839,277,-736    ),
new Location(811,556,-859     ),
new Location(-752,658,797     ),
new Location(-576,-505,-555   ),
new Location(-746,345,-682    ),
new Location(543,-455,-365    ),
new Location(851,590,554      ),
new Location(-399,-914,859    ),
new Location(436,-477,-381    ),
},
new Location[] {
new Location(695,-489,-727    ),
new Location(-393,764,-274    ),
new Location(513,-404,724     ),
new Location(733,406,705      ),
new Location(788,-449,-811    ),
new Location(804,-386,-777    ),
new Location(-591,-456,576    ),
new Location(-715,-313,-340   ),
new Location(-544,907,364     ),
new Location(135,43,-46       ),
new Location(-534,924,338     ),
new Location(-559,835,455     ),
new Location(-315,762,-398    ),
new Location(444,-463,823     ),
new Location(424,417,-730     ),
new Location(695,626,745      ),
new Location(-693,-291,-340   ),
new Location(-378,843,-372    ),
new Location(425,-525,753     ),
new Location(454,414,-693     ),
new Location(-604,-446,472    ),
new Location(-601,-248,-269   ),
new Location(465,460,-686     ),
new Location(-592,-563,407    ),
new Location(749,580,604      ),
new Location(76,148,91        ),
},
new Location[] {
new Location(455,-760,-649    ),
new Location(670,-470,334     ),
new Location(569,454,608      ),
new Location(-358,-652,-715   ),
new Location(-522,413,-718    ),
new Location(578,-408,376     ),
new Location(-499,503,-639    ),
new Location(-510,818,236     ),
new Location(-465,-659,-734   ),
new Location(530,478,-610     ),
new Location(534,643,-733     ),
new Location(-435,-673,316    ),
new Location(-123,-22,19      ),
new Location(-481,808,411     ),
new Location(630,-482,500     ),
new Location(-421,-818,-768   ),
new Location(541,457,-771     ),
new Location(-573,-797,318    ),
new Location(-490,705,351     ),
new Location(-535,-547,309    ),
new Location(-502,454,-681    ),
new Location(385,-756,-759    ),
new Location(330,-731,-694    ),
new Location(20,-66,-142      ),
new Location(736,518,636      ),
new Location(522,517,683      ),
},
new Location[] {
new Location(488,-495,-482    ),
new Location(753,833,793      ),
new Location(575,545,-722     ),
new Location(437,-478,-662    ),
new Location(-380,740,-476    ),
new Location(-589,-884,-619   ),
new Location(-447,-668,405    ),
new Location(512,-794,706     ),
new Location(66,67,-124       ),
new Location(-535,581,492     ),
new Location(-383,-610,455    ),
new Location(555,-671,789     ),
new Location(-392,808,-633    ),
new Location(-659,-782,-672   ),
new Location(-477,812,-495    ),
new Location(741,783,712      ),
new Location(-641,-817,-476   ),
new Location(721,728,746      ),
new Location(-433,523,401     ),
new Location(513,-605,602     ),
new Location(613,677,-617     ),
new Location(188,-120,-51     ),
new Location(-553,-645,460    ),
new Location(400,-493,-422    ),
new Location(-598,533,370     ),
new Location(546,787,-712     ),
},
new Location[] {
new Location(680,468,656      ),
new Location(-895,-366,652    ),
new Location(-732,-787,-709   ),
new Location(-801,-610,-698   ),
new Location(451,-753,587     ),
new Location(600,-429,-518    ),
new Location(-808,-712,-655   ),
new Location(-85,174,-91      ),
new Location(381,-734,525     ),
new Location(480,-665,466     ),
new Location(-787,899,-508    ),
new Location(-696,913,386     ),
new Location(-631,962,384     ),
new Location(-752,920,482     ),
new Location(499,-445,-344    ),
new Location(-864,885,-423    ),
new Location(-821,796,-468    ),
new Location(523,758,-784     ),
new Location(56,66,25         ),
new Location(466,693,-633     ),
new Location(593,624,698      ),
new Location(715,682,633      ),
new Location(501,782,-567     ),
new Location(-897,-420,814    ),
new Location(459,-483,-564    ),
new Location(-883,-452,696    ),
},
new Location[] {
new Location(397,-456,465     ),
new Location(822,541,-705     ),
new Location(-805,-570,-623   ),
new Location(484,-683,-391    ),
new Location(-592,793,-393    ),
new Location(-867,737,670     ),
new Location(-592,-860,531    ),
new Location(-506,805,-437    ),
new Location(-881,820,497     ),
new Location(-560,807,-275    ),
new Location(432,554,511      ),
new Location(-12,12,62        ),
new Location(780,662,-607     ),
new Location(467,492,474      ),
new Location(406,-399,601     ),
new Location(773,606,-703     ),
new Location(328,-770,-433    ),
new Location(-893,-541,-502   ),
new Location(-503,-915,463    ),
new Location(330,-529,600     ),
new Location(408,439,440      ),
new Location(-715,-853,455    ),
new Location(-849,835,649     ),
new Location(542,-805,-456    ),
new Location(-129,-146,27     ),
new Location(-874,-471,-564   ),
},
new Location[] {
new Location(533,528,-756     ),
new Location(635,945,504      ),
new Location(924,-707,-431    ),
new Location(926,-248,469     ),
new Location(-453,651,678     ),
new Location(743,907,422      ),
new Location(18,113,48        ),
new Location(-426,-601,-285   ),
new Location(-587,-409,730    ),
new Location(-602,-306,668    ),
new Location(934,-310,681     ),
new Location(450,651,-713     ),
new Location(-736,841,-422    ),
new Location(788,-764,-440    ),
new Location(858,-303,558     ),
new Location(637,717,-755     ),
new Location(-701,958,-484    ),
new Location(685,867,414      ),
new Location(-219,-659,-318   ),
new Location(789,-634,-364    ),
new Location(-609,608,678     ),
new Location(-494,-457,635    ),
new Location(-602,695,664     ),
new Location(-672,954,-527    ),
new Location(-322,-639,-423   ),
},
new Location[] {
new Location(665,-972,357     ),
new Location(157,-75,5        ),
new Location(-645,524,554     ),
new Location(-661,-821,715    ),
new Location(552,-766,-295    ),
new Location(572,402,640      ),
new Location(534,-897,368     ),
new Location(-544,439,-366    ),
new Location(-641,414,484     ),
new Location(569,492,-403     ),
new Location(596,-852,-283    ),
new Location(-616,479,429     ),
new Location(-479,-856,715    ),
new Location(6,-31,124        ),
new Location(618,534,-400     ),
new Location(434,-798,-281    ),
new Location(593,563,629      ),
new Location(-537,458,-259    ),
new Location(-703,405,-322    ),
new Location(-338,-477,-268   ),
new Location(-580,-849,831    ),
new Location(758,440,633      ),
new Location(569,-955,356     ),
new Location(528,455,-423     ),
new Location(-490,-509,-253   ),
new Location(-511,-491,-351   ),
},
new Location[] {
new Location(388,-809,-352    ),
new Location(-367,872,532     ),
new Location(-415,-631,622    ),
new Location(743,-603,724     ),
new Location(-753,552,-643    ),
new Location(562,-642,690     ),
new Location(139,81,144       ),
new Location(451,-707,-384    ),
new Location(-381,-642,874    ),
new Location(383,456,849      ),
new Location(-411,-684,-537   ),
new Location(416,-685,-273    ),
new Location(-384,-613,831    ),
new Location(-338,776,398     ),
new Location(412,553,858      ),
new Location(399,591,733      ),
new Location(-264,869,422     ),
new Location(-733,574,-623    ),
new Location(-414,-599,-703   ),
new Location(674,-497,728     ),
new Location(48,-39,41        ),
new Location(389,865,-737     ),
new Location(-669,584,-587    ),
new Location(463,856,-635     ),
new Location(-348,-718,-636   ),
new Location(391,787,-525     ),
},
new Location[] {
new Location(-784,-392,606    ),
new Location(-484,366,661     ),
new Location(736,683,764      ),
new Location(-663,-858,-769   ),
new Location(833,-740,823     ),
new Location(-553,-789,-841   ),
new Location(821,-458,-849    ),
new Location(-765,-867,-843   ),
new Location(700,495,-558     ),
new Location(87,-2,28         ),
new Location(-325,324,752     ),
new Location(790,830,797      ),
new Location(705,-593,-833    ),
new Location(836,-846,942     ),
new Location(-418,392,698     ),
new Location(830,-555,-820    ),
new Location(1,-137,118       ),
new Location(870,-733,933     ),
new Location(662,640,-670     ),
new Location(-380,807,-844    ),
new Location(-301,683,-816    ),
new Location(-588,-458,571    ),
new Location(696,601,-489     ),
new Location(-412,705,-781    ),
new Location(-758,-468,681    ),
new Location(661,785,811      ),
},
new Location[] {
new Location(500,-759,-543    ),
new Location(637,-476,865     ),
new Location(844,524,-809     ),
new Location(691,-401,789     ),
new Location(755,549,-692     ),
new Location(-670,-822,952    ),
new Location(680,-578,858     ),
new Location(374,779,921      ),
new Location(-536,581,-571    ),
new Location(-543,-454,-324   ),
new Location(326,-743,-442    ),
new Location(-738,485,812     ),
new Location(-605,-435,-394   ),
new Location(-832,-768,954    ),
new Location(827,534,-783     ),
new Location(396,700,869      ),
new Location(-697,522,832     ),
new Location(-24,26,176       ),
new Location(-643,582,-740    ),
new Location(-484,-523,-423   ),
new Location(546,-705,-402    ),
new Location(-526,594,-675    ),
new Location(36,-123,83       ),
new Location(-648,564,835     ),
new Location(-714,-736,940    ),
new Location(311,819,948      ),
},
new Location[] {
new Location(-609,-865,-696   ),
new Location(-730,-552,628    ),
new Location(320,796,-676     ),
new Location(-480,446,-760    ),
new Location(-789,-814,-679   ),
new Location(752,-686,698     ),
new Location(86,-103,-33      ),
new Location(-54,-53,105      ),
new Location(601,-621,755     ),
new Location(-543,462,-794    ),
new Location(-688,-396,541    ),
new Location(312,517,722      ),
new Location(462,-422,-642    ),
new Location(426,-451,-511    ),
new Location(-557,806,840     ),
new Location(535,-710,720     ),
new Location(-619,825,770     ),
new Location(366,785,-669     ),
new Location(-849,-902,-681   ),
new Location(532,555,762      ),
new Location(-498,737,741     ),
new Location(444,-531,-542    ),
new Location(-665,-610,506    ),
new Location(323,826,-713     ),
new Location(-583,555,-710    ),
new Location(486,501,621      ),
},
new Location[] {
new Location(440,-949,710     ),
new Location(-548,356,729     ),
new Location(-860,601,-538    ),
new Location(464,-767,-452    ),
new Location(653,723,873      ),
new Location(-846,-908,-728   ),
new Location(440,436,-892     ),
new Location(-730,-861,516    ),
new Location(4,-62,-113       ),
new Location(541,420,-718     ),
new Location(407,-702,-603    ),
new Location(581,741,842      ),
new Location(484,727,848      ),
new Location(442,-791,-669    ),
new Location(-674,-844,415    ),
new Location(458,-926,798     ),
new Location(-923,-894,-813   ),
new Location(-880,-805,-768   ),
new Location(-93,-141,27      ),
new Location(-550,496,745     ),
new Location(400,474,-672     ),
new Location(-571,298,738     ),
new Location(-615,-768,460    ),
new Location(-867,703,-581    ),
new Location(-791,778,-527    ),
new Location(406,-925,854     ),
},
new Location[] {
new Location(647,354,627      ),
new Location(754,-710,818     ),
new Location(-32,-37,79       ),
new Location(-607,574,728     ),
new Location(706,-823,-325    ),
new Location(-440,806,-361    ),
new Location(811,-701,682     ),
new Location(-630,680,673     ),
new Location(686,-718,-428    ),
new Location(-604,-428,344    ),
new Location(627,391,574      ),
new Location(-907,-614,-778   ),
new Location(593,431,-839     ),
new Location(681,-777,683     ),
new Location(-481,-385,427    ),
new Location(452,429,-751     ),
new Location(557,452,-671     ),
new Location(9,100,-69        ),
new Location(-911,-657,-807   ),
new Location(-554,700,-421    ),
new Location(648,-856,-532    ),
new Location(-665,510,678     ),
new Location(640,355,394      ),
new Location(-670,-386,531    ),
new Location(-794,-719,-842   ),
new Location(-418,699,-345    ),
},
new Location[] {
new Location(345,-686,278     ),
new Location(590,445,375      ),
new Location(-10,-33,-90      ),
new Location(730,443,391      ),
new Location(-830,567,-808    ),
new Location(-329,-599,712    ),
new Location(-452,-400,-567   ),
new Location(725,770,-497     ),
new Location(-454,-606,663    ),
new Location(788,466,382      ),
new Location(580,746,-507     ),
new Location(359,-589,272     ),
new Location(557,720,-571     ),
new Location(-688,531,-855    ),
new Location(-520,-433,-570   ),
new Location(-571,763,607     ),
new Location(363,-758,247     ),
new Location(-794,543,-728    ),
new Location(-464,-557,820    ),
new Location(-121,76,13       ),
new Location(-599,-325,-596   ),
new Location(-469,671,559     ),
new Location(-529,590,644     ),
new Location(520,-828,-781    ),
new Location(507,-818,-949    ),
new Location(499,-842,-763    ),
},
new Location[] {
new Location(898,-783,-440    ),
new Location(922,437,482      ),
new Location(-471,-599,844    ),
new Location(754,-763,593     ),
new Location(74,-14,20        ),
new Location(-699,-844,-819   ),
new Location(905,-782,548     ),
new Location(7,-163,-135      ),
new Location(864,402,436      ),
new Location(-386,-589,679    ),
new Location(427,680,-886     ),
new Location(405,573,-902     ),
new Location(-465,303,-496    ),
new Location(-661,-982,-715   ),
new Location(-477,-574,623    ),
new Location(-728,245,476     ),
new Location(-719,-949,-922   ),
new Location(541,574,-826     ),
new Location(-570,326,-576    ),
new Location(781,-845,-405    ),
new Location(-555,248,370     ),
new Location(-606,305,-408    ),
new Location(907,-709,651     ),
new Location(894,-740,-469    ),
new Location(916,504,488      ),
new Location(-697,342,327     ),
},
new Location[] {
new Location(246,-795,-450    ),
new Location(689,777,-513     ),
new Location(-737,-654,-829   ),
new Location(659,821,460      ),
new Location(300,-430,432     ),
new Location(-748,371,-546    ),
new Location(-636,391,-522    ),
new Location(-451,-517,506    ),
new Location(555,774,586      ),
new Location(-738,444,-507    ),
new Location(-33,-82,-118     ),
new Location(-476,718,803     ),
new Location(329,-622,-464    ),
new Location(-576,-488,551    ),
new Location(231,-643,-482    ),
new Location(-498,868,705     ),
new Location(632,681,465      ),
new Location(-737,-472,-794   ),
new Location(-853,-553,-822   ),
new Location(631,669,-596     ),
new Location(5,80,24          ),
new Location(344,-589,466     ),
new Location(-506,-492,441    ),
new Location(517,728,-493     ),
new Location(-469,691,760     ),
new Location(237,-596,485     ),
},
new Location[] {
new Location(299,519,833      ),
new Location(-547,650,-617    ),
new Location(395,-426,414     ),
new Location(-954,-698,761    ),
new Location(643,-437,-429    ),
new Location(-715,929,492     ),
new Location(-555,612,-825    ),
new Location(-856,-676,911    ),
new Location(-911,-705,734    ),
new Location(313,846,-260     ),
new Location(-657,-723,-474   ),
new Location(-658,986,590     ),
new Location(267,489,859      ),
new Location(-714,907,743     ),
new Location(371,-538,434     ),
new Location(342,863,-343     ),
new Location(671,-321,-510    ),
new Location(-592,-668,-449   ),
new Location(-702,-598,-445   ),
new Location(-134,142,-43     ),
new Location(-587,540,-648    ),
new Location(239,648,792      ),
new Location(356,-436,487     ),
new Location(678,-437,-611    ),
new Location(-22,23,114       ),
new Location(271,842,-392     ),
},
new Location[] {
new Location(353,649,717      ),
new Location(632,-572,-385    ),
new Location(627,-425,511     ),
new Location(569,-375,575     ),
new Location(-478,613,-778    ),
new Location(566,-759,-427    ),
new Location(420,506,769      ),
new Location(759,692,-309     ),
new Location(455,702,787      ),
new Location(742,512,-360     ),
new Location(592,-430,681     ),
new Location(-443,636,-564    ),
new Location(-678,-709,356    ),
new Location(744,452,-272     ),
new Location(-665,-529,392    ),
new Location(-606,857,594     ),
new Location(-792,-285,-709   ),
new Location(-685,-476,355    ),
new Location(39,-2,98         ),
new Location(-561,738,693     ),
new Location(-31,148,10       ),
new Location(-849,-421,-700   ),
new Location(-565,571,-622    ),
new Location(-538,915,708     ),
new Location(443,-676,-384    ),
new Location(-719,-420,-776   ),
}
};

var findIntersections = (List<Location> left, Location[] right) =>
{
    Adjusted? result = null;

    Parallel.For(0, 6, (d) =>
    {
        Parallel.For(0, 4, (r) =>
        {
            var rightTransformed = right.Select(o => o.WithDirection(d).WithRotation(r)).ToArray();

            foreach (var leftItem in left)
            {
                foreach (var rightItem in rightTransformed)
                {
                    var scanner = leftItem - rightItem;
                    var beacons = rightTransformed.Select(rt => rt + scanner).ToArray();

                    var intersections = beacons.Intersect(left, left.First()).Count();

                    if (intersections >= 12)
                        result = new Adjusted { Scanner = scanner, Beacons = beacons };
                }
            }
        });
    });

    return result;
};

var baseMap = input.First().ToList();
var scannerLocations = new List<Location>();
var unmapped = new Queue<Location[]>(input.Skip(1));

var sinceLast = 0;

while (unmapped.Any())
{
    var thisSector = unmapped.Dequeue();

    var transform = findIntersections(baseMap, thisSector);

    if (transform.HasValue) {
        foreach (var beacon in transform.Value.Beacons)
        {
            if (!baseMap.Any(b => b.X == beacon.X && b.Y == beacon.Y && b.Z == beacon.Z))
                baseMap.Add(beacon);
        }
        scannerLocations.Add(transform.Value.Scanner);

        sinceLast = 0;
        Console.WriteLine($"Remaining: {unmapped.Count}");
    }
    else {
        unmapped.Enqueue(thisSector);

        sinceLast++;
    }

    if (sinceLast > unmapped.Count)
    {
        //tested everthing, logic error
        throw new Exception("Logic Error");
    }
}

var maxDistance = 0;

foreach (var s1 in scannerLocations)
{
    foreach (var s2 in scannerLocations)
    {
        var difference = s1 - s2;
        var distance = (Math.Abs(difference.X) + Math.Abs(difference.Y) + Math.Abs(difference.Z));

        if (distance > maxDistance)
            maxDistance = distance;
    }
}

Console.WriteLine($"{baseMap.Count()} Beacons found");
Console.WriteLine($"{maxDistance} Is the largest Manhattan distance");

struct Adjusted
{
    public Location Scanner;
    public Location[] Beacons;
}

