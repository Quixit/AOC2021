// See https://aka.ms/new-console-template for more information

using System;
using System.Collections.Generic;

var input = new[]
{
    "[{{{{{<([({{<[<>()][{}()]>{<{}{}>{[]{}}}}{({{}{}][<>{}])(<<>()><{}<>>)}}<[<({}())<{}{}>>[[()[]](<>[])]]<(",
    "(<<({{({((([[{(){}}(<><>)][{[][]}<()()>>][[[()<>]<()()>]])))}(<(<[[{()<>}]({<>{}})]><<(<()[]>[[]{}])>[{{[",
    "<{<{({[<{<{([<<><>>[()[]]])[<{[]<>}<<>()>>]}{{<(()<>)<(){}>>(<[]<>>)}[<[()[]]<<>{}>>[{{}{}}[<><>]]>}>({",
    "[[[[[(<{(<<{<({}<>)<<><>>>{<<>()><<>()>]}<[<{}{}>{<>()}]<[{}[]][{}()]>>>[<({[]}{{}[]})<{<>{",
    "[[{[<(<(<(({{<{}()>{{}<>}}[<()[]><<>{}>]}(<[{}[]][{}[]]><<<>{}><()<>>])))>[[(({[{}[]][{}{}]}{<<>()>[(){}]",
    "<([[<<(([{<<{<[]><(){}>}<[{}][{}{}]>>{({{}()})[[[]()][()()]]}>}][<([[[{}{}][[]]]]<<<{}<>>{[][]",
    "({(<{{([({[{(<{}<>><{}[]>)<<[][]>{[]{}}>}{[{{}[]}[{}{}]]{{{}[]}{(){}}}}]}>]){<<{((([<><>])([<>[]]{{}(",
    "<{{{[{[(({<(<<{}{}>{<><>}>[{()[]}({}[])])([{()()}[<><>]](<{}()>({}())))><<(((){})[[]()])<(<>[",
    "{{<({<<<{<<[[{{}{}}<()[]>]]<<[<>[]]([]{})>[[[]](<>())]>>(([{<><>}])[{{{}()}(<>[])}<{[]<>}[{}",
    "{[<([[[(<[[[{[<>()]<()[]>}]{{{{}[]}{<>{}}}[([]())]}]<[({[]{}}(<>()>){<{}{}><()<>>}][((()[])[()[]])([()()]<[",
    "[([([(<(({{[[((){})({}{})]]<({{}()})<<[]>[<>[]]>>}{({[()()]([][])}(([])[[]<>]))(<{{}{}}[(){}",
    "({(<<({<<<(<[[[]()]]<[<>()]<()[]>}>[<<()()>>(<()[]>[[]])])({<<[]{}>{()[]}>({(){}}<<>[]>)}(<{(){}}<{}()>",
    "<[((<[[{[<<[({[]<>}<<>()>)](<[<><>]>{[{}[]]<{}[]>})><<[[<>()]<[][]>]<[{}<>](<><>)>>{{[<>{}",
    "<<<<<({[{[[[[<{}{}>]{((){}){<>[]}}][<([]{}){[]()}>[(<>())(<>[])]]]{{{<<>{}>({}())}(({}<>)[{}()])}}]({",
    "<[({<((<<[{(<(()()){<><>}><({}{})(<>{})>){[[()<>){{}<>}]([<>()]<[]<>>)}}<<[<{}[]>((){})][{{}[]}{()",
    "{([({{{<[<{{{[<><>>{[]()}}}(<((){})[<>[]]>(<[]<>>{{}<>}))}[[[[()()]<{}()>][[()<>]<{}[]>]]<<<[]()><()",
    "[{{(<[{<<{[{(<()[]>({}{}))[(<>){[]{}}]}({<<>{}>{<>()}}<<[]<>>(()())>)]((<[[]()]{{}{}}>{<<>>{<>{",
    "<[<{(<[({([({([]())([]())}({{}[]}{{}{}}))<{{{}{}}{{}()}}<[<>()][()()]>>]([[[{}{}][<><>]][[()<>]<{}{}>]",
    "[[<<{{<[[{<{({<>[]}[()()])[{()[]}[[]<>]]}<({[]}((){})){[[]()]<<><>>}>>}])><<{(<{{<[]<>>(<><>)}[<<>{}",
    "<([{[(<[<<[(({{}<>}{<><>})<{[]()}>)({{<><>><{}{}>}[([]())[{}()]])]>>[<[[[({}){[]()}][[()][",
    "<<<{(<(<[{([[[[]()]<()<>>](<<>[]>[{}[]])])}<[({<<>{}>([]{})})]>]<[([[({}{})(())]{({}{})}]({(()[])}<<[]{}>[(",
    "[{(([[({[({[[{()[]}<()<>>][[{}[]](<><>)]]((<{}<>>)({{}()}<()()>))}<{[[<>{}][[]()]]<[()()]{()",
    "{(<({<({<{((({()()}<{}[]>)(<(){}>[()()])){<{{}[]}{<>{}}>[<<>{}>[[]<>]]})<(<[<>{}]<{}<>>><[{}][()<>]>)",
    "<{{<<({{<<((<{[]}{()<>}><([][]){<>()}>)[{(<>())[<>[]]}{<<>()>(()())}])>((({{{}<>}<()()>}[(<>{})[",
    "{<({({{[<<<{[({}{})<{}[]>](<[]<>>(<>[]))}>({{{<>[]}({}[])}([()<>]({}<>))})>>({<((<<><>>{[]()})",
    "{[[(<{[<[([<[{{}}]((()<>){{}()})>(({<><>}{{}<>})<[[]]>)]<{[([][])[{}{}]](<[]{}><{}{}>}}[(([])[[]()])]>)]{(<<<",
    "{{((<[<<[[<(({<>}){<<><>>[[]<>]})[{{()<>}<[]{}>}([(){}]<{}{}>)]>]{<{<{()()}{{}}>[{[]<>}>}[<([]()){<>[]",
    "<{{[{[{[(({((<()()>({}<>)){((){})[[]{}]})}([{({}[])(()[])}[[<>{}]{(){}}]>)){(<<<{}>[<>()]>",
    "[<<<[<{<[{(<[[{}[]]([]{})]{<{}{}>{[][]}}>)[([[{}<>]{<>{}}](<{}{}>[{}]))((<<>{}>)<{()()}[[]{}]>)]}]>",
    "(<[<([{({{(([{[]<>}({}[])])<[({}())[{}{}]]{([][])({}<>)}>)<<<[<>{}]><({}<>)<<>()>>><{{()<>}[<>()]}(<<",
    "<{({(<<<{{{[[(<>{}){<><>}][[{}[]]]]<<(<><>){{}<>}><{<>{}}<()<>>>>}[[[((){}){{}()}][{<><>}<()()>]]",
    "<(<({{[[[<<(({{}{}}[<>[]]))(([<><>])<[{}()]<<>{}>>)>><({<<<>>[<>[]]><({}<>)<()[]>>}{(<<><>>{()<>})})>]]{{<",
    "(<([([(<<[[<[<[]>)(([][])[<><>])>]<[({(){}}<{}{}>)[<[][]>{()[]}]][<<<>{}>{(){}}><(()[])[[][]]>]>][{[({[]<>}<{",
    "{{<<<<<([<<((<{}{}>){{{}<>}<[][]]})(({{}()}<[]<>>)<<<>()>[[][]]>)>>])><(<{[{{[[]<>]<[][]>}}]}[<{(",
    "([[<[<({(<<{<((){}][()()]>[<{}()>[<>()]]}{{[<>[]]}{{[][]}{[][]}}}>(({[<>()]{[][]}}(<[]<>>(<>())))<{<()()",
    "[[[[<(<{{<[<([[]{}](()<>))<(<>[])[{}[]]>>{{(()<>)<{}{}>}{[()()][{}{}]}}]<[<<[]()>([]{})>{{",
    "{<[{<[[{{{{{((<><>)[<>[]])([<>{}]([]()))}([[{}[]](())][({}{}){{}()}])}}{((<<[]><(){}>>)<<<{}<>>{[]{}}>((()<>)",
    "<{[<[<{{((<<<[(){}](<>)>>{<[{}{}]<[]{}>>}>)([[{[[]<>][[][]]}(<<>()>(()<>))]>{(<[(){}][<>{}]>",
    "([({[[{([(([({[]{}}(()()))<<{})>])<<<[<><>][(){}]>({[]}{{}()})>([({}[]){(){}}][<<><>>([][])])>)(<([<<>[",
    "[(([[<{(<([({[[]{}]([]())}{<{}{}><[]<>>})(<<{}[]>[[]]>)][{<<[]{}>{{}<>})}([[()()][[]]]<<{}{}><{}{}>>)]",
    "<[[(<<<<{<[{[<[]()>]<(<>[])[[]{}]>}]<<{({}<>)([]<>)}>(((<><>)(()()))<<[][]>(<>)>)>>(<{[[{}[]]<<>{}>]}>",
    "<[<[{([<{(((([[]{}])<<<>()>[(){}]>)){<<[[]{}]{<>{}}>><[<()[]><[][]>]{[{}<>]<[][]>}>}){<{{[",
    "<[{<{<[<[[{{{{[][]}[{}()]}(<[]><()[]>)}<((<>()){()[]})[(<>[])]>}({[[{}[]]{[][]}]}(<<<>()>{<>[]}>[{{}[]}{<><",
    "<{{{<[[{<(((({[]{}}{[]{}})){[{()[]}({}{})]<<<>>(<>[])>})[(([(){}]<()<>>)({{}()}[{}{}]))<{({}[]){[]<>}}{[",
    "<{{([<([(({<<{<>[]}{(){}}>{({}()){{}<>}}>}<(<{<>{}}(()()>><((){})(())>)({<[]><<>>})>)[[{{[",
    "[{([[{<<{[(({{[][]}{{}[]}}[([]{}){()[]}]))({[[()()]][[<>()]{[]<>}]}{[({})[()<>]](<{}()]({}[]))})]}(<[<",
    "{{[{<{[{<<<(({()[]})<<()<>>>)><{<<()()>{[]()}><({}{})<<>{}>>>{<(()())[(){}]><([]<>)[[][]]>}",
    "<[[{{{{(<{<[[[[]()]<<>[]>][{{}{}}<[]()>]][[<{}{}>{{}<>}]{<<>{}>(())}]>{(({{}<>})[([][])<[]{}>]){{(<>{}){",
    "{<<{<{(([(({(<[]<>>{[]<>})[<[]<>><[]{}>]})[<({()<>}{{}{}})((()[])<{}()>)><((())){<()()>{[]}}>])([({[<",
    "<<[<{<{<((<[{[[]<>][()()]}({<>())[<>[]])][[(<>[])[(){}]]]>{{{<[][]>}{[[][]]<{}<>>}}((((){})<()()>)",
    "([<([[(<([([<(()()){(){}}>{(<>())<[]()>}]{({[][]})}){[<(<>())[[]{}]><[{}<>][{}{}]>){(<()>)[<<>{",
    "<[<(([{<[[[{<<<><>>(<>[]}>{{()}<[]()>}}{{<()>([]{})}<{<>[]}<{}[]>>}](<(<{}[]>{{}{}})[[<><>]<{}<>>]>{{<(){}",
    "<{{<(<{<[<(<(<<>>)[<()()><<><>>]>{{<<><>>([]<>)}})(<[([][])][(<>())(<>{})]>{[(()<>)[<><>]]",
    "[(([<<<[{{<{{{{}<>}([]<>)}<[{}[]][[]<>]>}([[[]{}][<><>]])><<[{{}}{[]<>}]<<{}[]>(()())>>[<[<><>]{<>()}>([()()]",
    "{[{([([[[(([{<[]()>([][])}([{}()][{}<>])](<(()[])<[]()>>([[][]])))<(<<(){}><[]()>>{[{}<>]}}({(()())<[][]>}",
    "((<(<{(<({(({([][])[[]{}]})<{<<>()>[<>()]}{[[]{}][[][]]}>){<({[][]}<{}{}>)<(<>())<{}[]>>>}}{{<",
    "([{[<(<(({[[{({}{})[{}<>]}{{<><>}}]{(<()<>>(<>{}))}][([({}[]){<>[]}]{({})})<[{{}<>}(<>())]{(<>{})((){})}>]}",
    "{[<<(<<[([[(<[()[]]([]())>{<<><>>{()()}})[((<>[])<()()>)<(()<>)<{}()>>]][[{[()](())}]]]{<(",
    "(<(<<{{[[{<(({{}<>}{[]<>}){([]<>){[][]}}){(<{}()>{()})[<<>{}>]}>}({[(<<>[]>([]<>))]<[[[]<>]{[]<>",
    "{(<<{<<[<{[{[<<>{}>([]{})]({<>[]]{()[]})}{[((){}){<>()}]{<[][]>([]<>)}}]<((<(){}>{()[]}){[<",
    "<<({({(<[<{{(<(){}>{[]})(<<><>><()()>)}}[({([]){<>{}}}{<<>{}><()<>>})]>(([[(<>()){(){}}]([(){})(<>()))",
    "{<[{(<([[{([<{[][]}([]{})>][([(){}])([[]<>](()[]))])[({[()<>][[]<>]}([<><>][<>[]])>]}]((<(((()",
    "(<[[[[[({<[[<({}<>)>(({}[])[{}()])][<{{}[]}(<>{})><<[]{}>{[]{}}>]]<<[{[]()}<{}[]>]<([]())[<><>]>>>><{<(<[]<>",
    "([[<(<[{<<<<({[]()}{()()})>><<{{<><>}<{}()>}(({}[])<<><>>)><({[]{}}{<>[]})<{[]{}}[[][]]>>>>>}(<[{([",
    "((((({({<{([{{{}()}({}<>)}{<{}[]><{}()>}][(<<><>><<>[]>)[{()<>}]])([[[<>{}][()()]]({<>[]}<()(",
    "<{[({{{{<{((({()<>}<{}<>>)[<[]{}>]){[<<>[]>[(){}]]})}<([<<{}{}>>{(()()){{}()}}][<<{}[]>[(){}]",
    "[({(([({{[{[[(()[])<[]()>]([{}[]][(){}])]{[{()[]}([]<>)]<[<>[]][<>()]>}}<(<({}())(<><>)>(<[]<>>{[]<>}))(({",
    "((<[<{[{<({{([<><>]<<>[]>)[[<>()]({}{})]}([{{}<>}[[]()]]{(<>{})({}<>)}]})<<{<[{}][{}]>[{[]",
    "<(<({(([((<{([<>()]<[][]>)}<{{()<>}([][])}>>)){({[{{[]<>}(<>{})}{{()}<{}<>>}](((()<>)([][]))[{()<>}[()<>]",
    "<([[({[[[({[[((){})(<>[])]][[((){})[{}{}]]([(){}][()<>])]})[[[(<[]<>>[{}[]])([[][]]<<>{}>)][{<[]{}>{<",
    "(([<<[{{[<<<<{{}[]}<[]{}>>{[()<>]({}[])}>(({{}})<({}[])<()<>>>)>>]{{[(((()())<[]()>){[()<>]{<>()}}){",
    "[{<([<({[<([{(<><>){()()}}{<<><>>({})]])<{[<[]()>[[]<>]]({[]()}<[]()>)}[[[(){}]((){})][[{}<>](",
    "[[({{({([({(<{()()}(<>{})>{([]())<[]()>})[([<>[]]{{}()}){([]())[<><>]}]}{{[([][]}[[]]]{<<>(",
    "<(<[({<<[([(<{[]<>}(<>())><([][])({}<>)>)<<{<>()}({}<>)><<{}<>>{()()}>>]({(<{}[]>([][])){<",
    "<[<{<(<({(<[{<()[]>{{}[]}}]({[()()](()[])}{({}{})([]<>)})>({([{}[]][<>()])<<<>{}>({}<>)>}))}<[({<[(",
    "[(<{{<{{(({<<{<>[]}([][])>><{[<>{}](<><>)}{[[]()]}>}((<({}{})<()[]>>)[<{<>[]}[{}<>]>]))({([",
    "[[<[{<(<([([[<()<>>{<><>}]](<<[]()><<>>>[[()[]]({}{})]))])><[((({(()[])<()<>>}[<<>{}><[][]>])<<{(",
    "<<{{<[{({<{<[[()<>][{}()>][({}<>)({}<>)]><<(<><>)[<><>]>>}([<{[][]}({}[])><({}{})>][(<<>()><",
    "([[(([[<{(<{{(()()){[][]}}<{{}}[(){}]>}<{[(){}]<{}{}>}>>{{{{[]<>}(<>[])}[<(){}>([]())])[<[<>",
    "{{(([{({((([[<[]{}>({}[])]({<>})]<[<[]()><[]<>>]({()<>](<>()))>){{[(<><>)[{}[]]][<<>{}>({}())]}(<<[][]>(<>()",
    "({<<{<[{<[(({[<><>]}{{{}[]}[[]{}]}){{{{}[]}<<><>>][([]())(())]})[<<[[]<>]<{}{}>><<{}[]><{}[]>>>({[<>[]]",
    "{[<({<(<[<([{{<>{}}{()<>}}([(){}]<[][]>)][(({}[]){()})([[][]]([]()))]>>]>)[<[(({[{{}[]}(()())]{<{}<>><[][]>}",
    "[([{<{{<({<[({<>[]}{()()})(<[]{}>[()[]])]{{({}[])<()[]>}[([]<>)((){})]}>})[{<<<[{}[]][(){}]",
    "{[[{<[<<[{<([[{}[]][{}()]]{[{}[]]{[]{}}})(({()<>}[{}()}){[[]{}]})>[{[<<>{}>]{({}<>)<{}{}>}}<{[[]<>]",
    "[{{{<([(<[[[(<<>{}><<>[]>){([]<>){[]<>}}]({[[]<>](<><>)}({<>{}}{{}()}))]{(({{}{}}<{}[]>}<<<>>>)}]",
    "{{<({(<(([<{{[()()]<[]<>>}}[<<[]{}>[<>()]>[(()())<<>>]]><<<{()()][<><>]>[<<><>>{()[]}]>{(<()[]>",
    "{{<([<[[{<({{({}())<{}()>}{<{}()>[[][]]}>)<<[<<><>>{()[]}]<{[]<>}(()[])>>>>}([{[<{<>{}}({}())>((<>",
    "[{[(<<(<[[[[({<>()}{<><>})]([<[][]><<>>])]{<({{}<>}[{}{}])[<{}<>><<><>>]>{[<<>[]><<>{}>]{[",
    "((((<{{(<[{{{{()[]}[()<>]}[([]())[<>{}]]}{{[()()]<()<>>}<<<>{}><[]>>}}<((<<>>)[{[][]}<<>()>])<[<[]{}>(",
    "<[<<[<{([(<(<(()())(()())>{(()[])<{}()>})({[[]()][[][]]})><{{{{}>[{}{}]}[<{}()>[(){}]]}{{{()()}{()[",
    "<<<[(([([{<({<(){}>}{[()[]]{<>[]}})}{[(<[]{}>{{}()})({{}<>})]((<()[]>)<([]<>)>)}}({[{{<>()}{<>()}}(<(){}>[",
    "{<<(({[[<<<{(({}{}}{<>[]})[{<>()}{()[]}]}(({<>[]}[{}{}]){{(){}}[()<>]})>[[<{[][]}[<>{}]>][[<()<>><()[]>]{",
    "(([[<({{{({<[(()[])[[]{}]]>}[{(<[][]>[{}<>]){{[]{}}(<>()]}}({[[]()]}[<[][]>([]())])])}{{[{([{}()](<",
    "[([<<({(([<<([[]{}]<()()>){<{}<>>[[]{}]}>[[<[]{}>(<><>)]{{(){}}[<><>]}]><({(<><>)(()())}{{(){}}((){}"
};

var errorScore = 0L;
var completionScores = new List<long>();
var stack = new Stack<char>();
var values = new Dictionary<char, long>
{
    {')', 3},
    {']', 57},
    {'}', 1197},
    {'>', 25137}
};

foreach (var line in input)
{
    var error = false;

    foreach (var character in line)
    {
        if (character is '(')
        {
            stack.Push(')');
        }
        else if (character is '[')
        {
            stack.Push(']');
        }
        else if (character is '{')
        {
            stack.Push('}');
        }
        else if (character is '<')
        {
            stack.Push('>');
        }
        else if (character != stack.Pop())
        {
            errorScore += values[character];
            error = true;
            break;
        }
    }

    if (!error && stack.Count > 0)
    {
        var completionScore = 0L;

        while (stack.Count > 0)
        {
            completionScore *= 5;

            switch (stack.Pop())
            {
                case ')':
                    completionScore += 1;
                    break;
                case ']':
                    completionScore += 2;
                    break;
                case '}':
                    completionScore += 3;
                    break;
                case '>':
                    completionScore += 4;
                    break;
            }
        }

        completionScores.Add(completionScore);
    }

    stack.Clear();
}

completionScores.Sort();

Console.WriteLine($"Error score: {errorScore} Completion score: {completionScores[(completionScores.Count / 2)]}");